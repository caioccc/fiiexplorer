{% extends 'base.html' %}
{% load staticfiles %}
{% load filters %}
{% block content %}
    <style>
        .list_fii_segmento {
            padding: 0px;
            margin: 4px 4px;
            display: inline-block;
        }
    </style>
    <div class="row">
        <div class="col-xs-12">
            <div class="box box-default">
                <div class="box-header">
                    <div class="row">
                        <div class="col-xs-12">
                            <form action="#" method="get" class="form-inline">
                                <div class="form-group">
                                    <label class="sr-only" for="exampleInputAmount">Amount (in dollars)</label>
                                    <div class="input-group">
                                        <div class="input-group-addon">
                                            <i class="fa fa-search"></i>
                                        </div>
                                        <input type="text" class="form-control" id="q" name="q"
                                               placeholder="Buscar...">
                                    </div>
                                </div>
                                <button type="submit" class="btn btn-primary mb-2">Buscar</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="box box-default">
        <div class="box-header">
            <label class="box-title">
                Programação Ao Vivo
            </label>
        </div>
        <div class="box-body">
            <div class="row">
                <div class="col-xs-12">
                    <div id="Carousel" class="carousel slide" data-ride="carousel">

                        <ol class="carousel-indicators">
                            {% for page in json %}
                                <li data-target="#Carousel" data-slide-to="{{ forloop.counter0 }}"
                                    {% if forloop.counter0 == 0 %}class="active"{% endif %}></li>
                            {% endfor %}
                        </ol>

                        <!-- Carousel items -->

                        <div class="carousel-inner">
                            {% for page in json %}
                                <div class="item {% if forloop.counter0 == 0 %}active{% endif %}">
                                    <div class="row">
                                        {% for item in page %}
                                            <div class="col-xs-6 col-sm-3">
                                                <div class="item-channel item item-cnl"
                                                     data-id="{{ item.canalid }}">
                                                    <a href="#">
                                                        <div class="info-channel">
                                                            <img class="owl-lazy img-responsive"
                                                                 data-src="{{ item.canal.logoBrancoUrl }}"
                                                                 alt="{{ item.slug }}"
                                                                 src="{{ item.canal.logoBrancoUrl|get_image }}"
                                                                 style="opacity: 1;"/>
                                                        </div>
                                                        <div class="img-prog-channel">
                                                            <img class="owl-lazy img-responsive"
                                                                 data-src="{{ item.imagemUrl }}"
                                                                 alt="{{ item.slug }}"
                                                                 src="{{ item.imagemUrl|get_image }}"
                                                                 style="opacity: 1;"/>
                                                        </div>
                                                        <div class="info-prog-channel"><b>{{ item.canal.nome }}</b>
                                                            <div class="prog-atu-pass">{{ item.titulo }}</div>
                                                        </div>
                                                    </a>
                                                </div>
                                            </div>
                                        {% endfor %}

                                    </div><!--.row-->
                                </div><!--.item-->
                            {% endfor %}

                        </div><!--.carousel-inner-->
                        <a data-slide="prev" href="#Carousel" class="left carousel-control">‹</a>
                        <a data-slide="next" href="#Carousel" class="right carousel-control">›</a>
                    </div>
                </div>
                <script>
                    $(document).ready(function () {
                        $('#Carousel').carousel({
                            interval: 5000
                        })
                    });

                  //  setTimeout(attCanais, 5000);

                    function attCanais() {

                        $.ajax({
                            method: "GET",
                            url: "{% url 'get-json' %}"
                        })
                            .done(function (dados) {
                                $(dados).each(function (index, data) {
                                    //console.log(index, data);
                                    //$(".item-cnl[data-id='" + data.canal._id + "'] .prog-atu-pass").html(data.titulo);
                                    //$(".item-cnl[data-id='" + data.canal._id + "'] a").attr('href', 'https://canaismax.com/' + data.slug);
                                    //$(".item-cnl[data-id='" + data.canal._id + "'] .img-prog-channel img").attr("data-src", data.imagemUrl);
                                    //if ($(".item-cnl[data-id='" + data.canal._id + "'] .img-prog-channel img").attr("src")) {
                                    //    $(".item-cnl[data-id='" + data.canal._id + "'] .img-prog-channel img").attr("src", data.imagemUrl);
                                    //}
                                });
                                setTimeout(attCanais, 5000);
                            });

                    }
                </script>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-md-12">
            <div class="box box-primary">
                <div class="box box-header">
                    <div class="row">
                        <div class="col-xs-12">
                            <a href="{% url 'collect-canaismax' %}" class="btn btn-primary">
                                <i class="fa fa-rocket"></i> <span>Collect Channels Max</span>
                            </a>
                        </div>
                    </div>
                </div>
                <!-- form start -->
                <div class="box-body">
                    <div class="row">
                        {% for canal in canais %}

                            <div class=" text-center col-xs-6 col-sm-4 col-md-3">
                                <div class="box box-default" style="border-top: None;">
                                    <!-- /.box-header -->
                                    <div class="box-body">
                                        <a href="{% url 'view-channel' canal.pk %}">
                                            <img src="{{ canal.img_url }}"
                                                 class="img-responsive img-thumbnail"
                                                 style="
                                                         {% if site == 'topcanais' %}

                                                         {% else %}
                                                             background-color: #1a2226;
                                                         {% endif %}
                                                         "
                                            />
                                        </a>
                                    </div>
                                    <!-- /.box-body -->
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="text/javascript">

        $(document).ready(function () {
        });
    </script>

{% endblock %}
