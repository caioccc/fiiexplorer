{% extends 'base.html' %}
{% load staticfiles %}
{% load filters %}

{% block content %}
    <link rel="stylesheet" href='{% static 'css/style-view-channel.css' %}'/>
    <script src="//cdn.jsdelivr.net/npm/clappr@latest/dist/clappr.min.js"></script>
    <script src='//cdn.jsdelivr.net/npm/@clappr/hlsjs-playback@latest/dist/hlsjs-playback.min.js'></script>
    <script type="text/javascript"
            src="//cdn.jsdelivr.net/gh/clappr/clappr-level-selector-plugin@latest/dist/level-selector.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@clappr/stats-plugin@latest/dist/clappr-stats.min.js"
            type="text/javascript"></script>

    <div class="row">
        <div class="col-xs-6">
            <a href="{% url 'select-multicanais' %}"
               class="btn btn-default">Voltar</a>
        </div>
    </div>
    <br/>
    <script>

        function getSecondsString(fileSizeInBytes) {
            return fileSizeInBytes.toFixed(1) + ' s';
        };

        function getReadableFileSizeString(fileSizeInBytes) {

            var i = -1;
            var byteUnits = [' kbps', ' Mbps', ' Gbps', ' Tbps', 'Pbps', 'Ebps', 'Zbps', 'Ybps'];
            do {
                fileSizeInBytes = fileSizeInBytes / 1024;
                i++;
            } while (fileSizeInBytes > 1024);

            return Math.max(fileSizeInBytes, 0.1).toFixed(1) + byteUnits[i];
        };
    </script>
    <div class="row">
        {% for channel in channels %}
            <div class="col-xs-4">
                <div id="Player{{ channel.id }}">
                </div>
            <br/>
            </div>
            <script>

                var player_{{ channel.id }} = new Clappr.Player({
                    parentId: "#Player{{ channel.id }}",
                    autoPlay: true,
                    mute: true,
                    poster: "{{ channel.img_url }}",
                    source: window.location.origin + "{% url 'playlist-m3u8-multicanais' %}?uri=" + "{{ channel.link_set.first.m3u8 }}",
                    width: '100%',
                    height: "200px",
                    mediacontrol: {seekbar: "#900", buttons: "#FFFFFF"},
                    plugins: [HlsjsPlayback, LevelSelector,],
                    playback: {
                        hlsjsConfig: {
                            liveSyncDurationCount: 7,
                            maxBufferHole: 3,
                        }
                    },
                });
                player.setVolume(100);
                player.play();

            </script>
        {% endfor %}
    </div>




{% endblock %}
